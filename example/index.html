<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Worker Demo</title>
	<style type="text/css">
    html, body {
	    height: 100%;
	    overflow: auto;
    }
    body {
	    padding: 0;
	    margin: 0;
    }
	</style>
</head>
<body>
  <div id="supported">&nbsp;</div>
  <div id="out">Calculating in thread...</div>
  <form id="form1" runat="server" style="height:0px;width:0px;">
    <div id="silverlightControlHost">
      <object id="obj" data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="1" height="1">
		      <param name="source" value="ss.xap"/>
		      <param name="onError" value="onSilverlightError" />
		      <param name="background" value="white" />
		      <param name="onLoad" value="onSilverlightLoad" />
		      <param name="onunLoad" value="this.Content.sl.close()" />
		      <param name="minRuntimeVersion" value="3.0.40818.0" />
		      <param name="autoUpgrade" value="true" />
      </object>
      <iframe id="_sl_historyFrame" style="visibility:hidden;height:0px;width:0px;border:0px"></iframe>
    </div>
  </form>
<br/>
<input type="button" value="click me 25 times" onclick="document.getElementById('test').innerHTML=parseInt(document.getElementById('test').innerHTML,10)+1;"/><br/>
<div id="test">0</div>
<script type="text/javascript">
  onSilverlightError = function(sender, args) {
    throw new Error(args.ErrorType+ ": "+args.ErrorCode);
  };

  onSilverlightLoad = function(){
    var obj = document.getElementById('obj');        
    obj.Content.sl.worker("http://inficron.com/worker/worker.js");
    obj.Content.sl.postmessage("Hi from parent!");                  
  };
          
  workercompleted = function(result){  
    alert("Workercompleted: "+result);      
  };
  
  workermessage = function(msg){
    document.getElementById('out').innerHTML=document.getElementById('out').innerHTML+' '+msg;
  }; 
	try{
		if(Worker){
			//use standard workers
		}
	}catch(err){
    document.getElementById('supported').innerHTML='[fyi, this browser does not natively support HTML5 workers]';
  }       
</script>    
</body>
</html>
